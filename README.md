This code is written in Fortran 90/95 and implements the coupled 2D Lattice Boltzmann Method with the D2Q9 velocity set for flow over a self-affine surface (or more precisely profile).

Hurst.f90 generates a self-affine surface with specified Hurst exponent, discretizes it over a square lattice of unit length and labels the lattice sites. The labels are: 0 for solid nodes, 1 for fluid nodes in the bulk of the fluid. The boundary nodes have several labels indicating the local shape of the boundary around the node. The labeled lattice which is generated is printed on two files: 'state.dat', which is intended to be used by the programs implementing the LBM; 'labeled_lattice.dat' which is formatted for plotting. (I use Gnuplot 5.2 with the command "p 'labeled_lattice.dat' u 1:2:3 w labels")

Rough.f90 implements the coupled LBM for fluid with varying solute concentration, over the surface specified by 'state.dat'. The sistem is initially filled with high-solute-concentration fluid, and solute-free fluid is injected at the inlet. The fluid density and solute concentration are initialized to 1 everywhere, while the fluid velocity is initialized to 0 everywhere. The boundary conditions imposed for the velocity are no-slip on the bottom surface (which is the self-affine profile), free-slip on the top surface, and zero-gradient at inlet and outlet. The boundary conditions imposed for the solute concentration are the same as for the velocity except at the inlet, where the solute concentration is set to have a costant value (C=0). The solute concentration and fluid speed fields are printed in the file 'concentration_field.dat'; the velocity field is printed in 'velocity_field.dat' and the speed averaged over the system, the solute concentration integrated over the system and the total fluid mass are printed in 'average.dat'.

Rough_temp.f90 implements the coupled LBM for fluid with varying temperature, over the surface specified by 'state.dat'. The sistem is initially filled with cold fluid, and warm fluid is injected at the inlet. The fluid density and temperature are initialized to 1 everywhere, while the fluid velocity is initialized to 0 everywhere. The boundary conditions imposed for the velocity are the same as those in Rough.f90. The boundary conditions imposed for the temperature are free-slip on the top surface, and zero gradient at the oulet. The temperatuere is set to have constant values at the inlet (C=1), and on the bottom surface (C=0). The solute temperature and fluid speed fields are printed in the file 'concentration_field.dat'; the velocity field is printed in 'velocity_field.dat' and the speed averaged over the system, the temperature integrated over the system and the total fluid mass are printed in 'average.dat'.
